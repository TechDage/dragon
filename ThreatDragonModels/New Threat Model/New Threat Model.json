{
  "version": "2.5.0",
  "summary": {
    "title": "New Threat Model",
    "owner": "",
    "description": "",
    "id": 0
  },
  "detail": {
    "contributors": [],
    "diagrams": [
      {
        "id": 0,
        "title": "New STRIDE diagram",
        "diagramType": "STRIDE",
        "placeholder": "New STRIDE diagram description",
        "thumbnail": "./public/content/images/thumbnail.stride.jpg",
        "version": "2.5.0",
        "cells": [
          {
            "position": {
              "x": 330,
              "y": 210
            },
            "size": {
              "width": 490,
              "height": 620
            },
            "attrs": {
              "label": {
                "text": "internal network"
              }
            },
            "visible": true,
            "shape": "trust-boundary-box",
            "zIndex": -1,
            "id": "a6d001a9-2fdb-421c-824c-94ab06198d19",
            "data": {
              "type": "tm.BoundaryBox",
              "name": "internal network",
              "description": "internet\n\n",
              "isTrustBoundary": true,
              "hasOpenThreats": false
            }
          },
          {
            "position": {
              "x": 30,
              "y": 170
            },
            "size": {
              "width": 160,
              "height": 120
            },
            "attrs": {
              "text": {
                "text": "Operators and attackers"
              },
              "body": {
                "stroke": "#333333",
                "strokeWidth": 1.5,
                "strokeDasharray": null
              }
            },
            "visible": true,
            "shape": "actor",
            "zIndex": 1,
            "ports": {
              "groups": {
                "top": {
                  "position": "top",
                  "attrs": {
                    "circle": {
                      "r": 4,
                      "magnet": true,
                      "stroke": "#5F95FF",
                      "strokeWidth": 1,
                      "fill": "#fff",
                      "style": {
                        "visibility": "hidden"
                      }
                    }
                  }
                },
                "right": {
                  "position": "right",
                  "attrs": {
                    "circle": {
                      "r": 4,
                      "magnet": true,
                      "stroke": "#5F95FF",
                      "strokeWidth": 1,
                      "fill": "#fff",
                      "style": {
                        "visibility": "hidden"
                      }
                    }
                  }
                },
                "bottom": {
                  "position": "bottom",
                  "attrs": {
                    "circle": {
                      "r": 4,
                      "magnet": true,
                      "stroke": "#5F95FF",
                      "strokeWidth": 1,
                      "fill": "#fff",
                      "style": {
                        "visibility": "hidden"
                      }
                    }
                  }
                },
                "left": {
                  "position": "left",
                  "attrs": {
                    "circle": {
                      "r": 4,
                      "magnet": true,
                      "stroke": "#5F95FF",
                      "strokeWidth": 1,
                      "fill": "#fff",
                      "style": {
                        "visibility": "hidden"
                      }
                    }
                  }
                }
              },
              "items": [
                {
                  "group": "top",
                  "id": "e72222e7-6458-4dce-8b44-af1514ffbd92"
                },
                {
                  "group": "right",
                  "id": "b784f26e-c23e-4e83-9156-07c0916b664b"
                },
                {
                  "group": "bottom",
                  "id": "f6dd2ff1-0ce5-4cd4-aa4a-65ddf048a168"
                },
                {
                  "group": "left",
                  "id": "eb3ba845-2ad5-4011-9220-e38d5d3c69eb"
                }
              ]
            },
            "id": "37aafa70-5cea-48a0-a86d-e0d61fa6e6be",
            "data": {
              "type": "tm.Actor",
              "name": "Operators and attackers",
              "description": "",
              "isTrustBoundary": false,
              "outOfScope": false,
              "reasonOutOfScope": "",
              "hasOpenThreats": false,
              "providesAuthentication": false,
              "threats": [],
              "threatFrequency": {
                "spoofing": 4,
                "repudiation": 0
              }
            }
          },
          {
            "shape": "flow",
            "attrs": {
              "line": {
                "stroke": "#333333",
                "targetMarker": {
                  "name": "block"
                },
                "sourceMarker": {
                  "name": ""
                },
                "strokeDasharray": null
              }
            },
            "width": 200,
            "height": 100,
            "zIndex": 10,
            "connector": "smooth",
            "data": {
              "type": "tm.Flow",
              "name": "query process data",
              "description": "",
              "outOfScope": false,
              "isTrustBoundary": false,
              "reasonOutOfScope": "",
              "hasOpenThreats": false,
              "isBidirectional": false,
              "isEncrypted": false,
              "isPublicNetwork": false,
              "protocol": "",
              "threats": []
            },
            "labels": [
              "query process data"
            ],
            "id": "c72f6be3-4a7d-4b1e-aeb2-6da8eace7054",
            "source": {
              "x": 480,
              "y": 380
            },
            "target": {
              "x": 480,
              "y": 490
            }
          },
          {
            "shape": "flow",
            "attrs": {
              "line": {
                "stroke": "#333333",
                "targetMarker": {
                  "name": "block"
                },
                "sourceMarker": {
                  "name": ""
                },
                "strokeDasharray": null
              }
            },
            "width": 200,
            "height": 100,
            "zIndex": 10,
            "connector": "smooth",
            "data": {
              "type": "tm.Flow",
              "name": "control commands",
              "description": "",
              "outOfScope": false,
              "isTrustBoundary": false,
              "reasonOutOfScope": "",
              "hasOpenThreats": false,
              "isBidirectional": false,
              "isEncrypted": false,
              "isPublicNetwork": false,
              "protocol": "",
              "threats": []
            },
            "labels": [
              "control commands"
            ],
            "id": "4f4dce66-e1a1-4e8e-afee-50b09a97a5f4",
            "source": {
              "x": 1025,
              "y": 182
            },
            "target": {
              "x": 1170,
              "y": 240
            },
            "vertices": []
          },
          {
            "shape": "flow",
            "attrs": {
              "line": {
                "stroke": "#333333",
                "targetMarker": {
                  "name": "block"
                },
                "sourceMarker": {
                  "name": ""
                },
                "strokeDasharray": null
              }
            },
            "width": 200,
            "height": 100,
            "zIndex": 10,
            "connector": "smooth",
            "data": {
              "type": "tm.Flow",
              "name": "Telemetry feedback",
              "description": "",
              "outOfScope": false,
              "isTrustBoundary": false,
              "reasonOutOfScope": "",
              "hasOpenThreats": false,
              "isBidirectional": false,
              "isEncrypted": false,
              "isPublicNetwork": false,
              "protocol": "",
              "threats": []
            },
            "labels": [
              "Telemetry feedback"
            ],
            "id": "23c29b86-fde3-4088-bbe0-f23a4ce65648",
            "source": {
              "x": 1210,
              "y": 360
            },
            "target": {
              "x": 1140,
              "y": 610
            },
            "vertices": [
              {
                "x": 1170,
                "y": 479
              },
              {
                "x": 1170,
                "y": 500
              }
            ]
          },
          {
            "shape": "flow",
            "attrs": {
              "line": {
                "stroke": "#333333",
                "targetMarker": {
                  "name": "block"
                },
                "sourceMarker": {
                  "name": ""
                },
                "strokeDasharray": null
              }
            },
            "width": 200,
            "height": 100,
            "zIndex": 10,
            "connector": "smooth",
            "data": {
              "type": "tm.Flow",
              "name": "Sensor data",
              "description": "",
              "outOfScope": false,
              "isTrustBoundary": false,
              "reasonOutOfScope": "",
              "hasOpenThreats": false,
              "isBidirectional": false,
              "isEncrypted": false,
              "isPublicNetwork": false,
              "protocol": "",
              "threats": []
            },
            "labels": [
              "Sensor data"
            ],
            "id": "22ddb8f1-59f8-4a23-b084-e79eca96b398",
            "source": {
              "x": 1170,
              "y": 330
            },
            "target": {
              "x": 1022,
              "y": 627
            },
            "vertices": [
              {
                "x": 1080,
                "y": 390
              },
              {
                "x": 1022,
                "y": 470
              },
              {
                "x": 990,
                "y": 550
              },
              {
                "x": 1022,
                "y": 590
              }
            ]
          },
          {
            "shape": "flow",
            "attrs": {
              "line": {
                "stroke": "red",
                "strokeWidth": 2.5,
                "targetMarker": {
                  "name": "block"
                },
                "sourceMarker": {
                  "name": ""
                },
                "strokeDasharray": null
              }
            },
            "width": 200,
            "height": 100,
            "zIndex": 10,
            "connector": "smooth",
            "data": {
              "type": "tm.Flow",
              "name": "System configuration store",
              "description": "",
              "outOfScope": false,
              "isTrustBoundary": false,
              "reasonOutOfScope": "",
              "hasOpenThreats": true,
              "isBidirectional": false,
              "isEncrypted": false,
              "isPublicNetwork": false,
              "protocol": "",
              "threats": [
                {
                  "id": "b4df64fb-2b7b-4ea9-8722-f30dd47bebb4",
                  "title": "Tampering with the config store",
                  "status": "Open",
                  "severity": "TBD",
                  "type": "Tampering",
                  "description": "Configuration data like the auto mode which is enabled and other dosing values can be changed without validation. Wrong dosing logic can lead to unsafe water and chemical balance.",
                  "mitigation": "By adding authentication, checksum verification and admin approval workflow this could be mitigated. Aswell as a role specific lock. ",
                  "modelType": "STRIDE",
                  "new": false,
                  "number": 8,
                  "score": ""
                },
                {
                  "id": "041f950f-7e02-4f3e-af54-34ee9a30decd",
                  "title": "Config store info discl ",
                  "status": "Open",
                  "severity": "Medium",
                  "type": "Information disclosure",
                  "description": "Sensitive system configuration like the PLC Ips and credentials stored in plaintext. If a leak happens it then allows targeted PLC or database attacks.",
                  "mitigation": "Encrypt configuration files, use secret vaults and enforce a strong access control.",
                  "modelType": "STRIDE",
                  "new": false,
                  "number": 12,
                  "score": ""
                }
              ],
              "threatFrequency": {
                "tampering": 1,
                "informationDisclosure": 1,
                "denialOfService": 0
              }
            },
            "labels": [
              "System configuration store"
            ],
            "id": "48cfffb8-cb67-4a52-b22a-967892894a22",
            "source": {
              "x": 560,
              "y": 400
            },
            "target": {
              "cell": "54864b68-7021-4826-b997-6e01bfedc12f",
              "port": "eb3ba845-2ad5-4011-9220-e38d5d3c69eb"
            },
            "vertices": [
              {
                "x": 600,
                "y": 685
              }
            ]
          },
          {
            "shape": "flow",
            "attrs": {
              "line": {
                "stroke": "red",
                "strokeWidth": 2.5,
                "targetMarker": {
                  "name": "block"
                },
                "sourceMarker": {
                  "name": ""
                },
                "strokeDasharray": null
              }
            },
            "width": 200,
            "height": 100,
            "zIndex": 10,
            "connector": "smooth",
            "data": {
              "type": "tm.Flow",
              "name": "API calls",
              "description": "",
              "outOfScope": false,
              "isTrustBoundary": false,
              "reasonOutOfScope": "",
              "hasOpenThreats": true,
              "isBidirectional": false,
              "isEncrypted": false,
              "isPublicNetwork": false,
              "protocol": "",
              "threats": [
                {
                  "id": "6235e7c6-7a80-4927-ae24-70061d1ea229",
                  "title": "Tampering the API calls",
                  "status": "Open",
                  "severity": "Medium",
                  "type": "Tampering",
                  "description": "API traffic between HMI and control server is unencrypted with http. This means an attacker can alter Innløpsmengde or dosing values in the message.",
                  "mitigation": "Use HTTPS or TLS 1.2. Aswell as integrity checks and encrypted communications.",
                  "modelType": "STRIDE",
                  "new": false,
                  "number": 7,
                  "score": ""
                }
              ],
              "threatFrequency": {
                "tampering": 1,
                "informationDisclosure": 0,
                "denialOfService": 0
              }
            },
            "labels": [
              "API calls"
            ],
            "id": "ddbe6c6c-0140-423f-a1ee-1197dccb8efb",
            "source": {
              "x": 590,
              "y": 330
            },
            "target": {
              "cell": "cf4b2fca-947f-473a-a644-d47a6fba299c",
              "port": "8ae89fca-2c2c-446d-a1e9-c6446e3d9a98"
            },
            "vertices": [
              {
                "x": 640,
                "y": 390
              },
              {
                "x": 780,
                "y": 330
              }
            ]
          },
          {
            "shape": "flow",
            "attrs": {
              "line": {
                "stroke": "#333333",
                "targetMarker": {
                  "name": "block"
                },
                "sourceMarker": {
                  "name": ""
                },
                "strokeDasharray": null
              }
            },
            "width": 200,
            "height": 100,
            "zIndex": 10,
            "connector": "smooth",
            "data": {
              "type": "tm.Flow",
              "name": "",
              "description": "",
              "outOfScope": false,
              "isTrustBoundary": false,
              "reasonOutOfScope": "",
              "hasOpenThreats": false,
              "isBidirectional": false,
              "isEncrypted": false,
              "isPublicNetwork": false,
              "protocol": "",
              "threats": []
            },
            "labels": [
              ""
            ],
            "id": "f9630f5d-e6c0-4acc-9b6e-5a2c49b00960",
            "source": {
              "x": 569,
              "y": 290
            },
            "target": {
              "x": 880,
              "y": 170
            },
            "vertices": [
              {
                "x": 690,
                "y": 240
              }
            ]
          },
          {
            "shape": "flow",
            "attrs": {
              "line": {
                "stroke": "#333333",
                "targetMarker": {
                  "name": "block"
                },
                "sourceMarker": {
                  "name": ""
                },
                "strokeDasharray": null
              }
            },
            "width": 200,
            "height": 100,
            "zIndex": 10,
            "connector": "smooth",
            "data": {
              "type": "tm.Flow",
              "name": "HTTP request",
              "description": "",
              "outOfScope": false,
              "isTrustBoundary": false,
              "reasonOutOfScope": "",
              "hasOpenThreats": false,
              "isBidirectional": false,
              "isEncrypted": false,
              "isPublicNetwork": false,
              "protocol": "",
              "threats": [],
              "threatFrequency": {
                "tampering": 1,
                "informationDisclosure": 0,
                "denialOfService": 0
              }
            },
            "labels": [
              "HTTP request"
            ],
            "id": "0f6f38e1-d4f8-46a6-93fb-95acc757a9f5",
            "source": {
              "x": 190,
              "y": 290
            },
            "target": {
              "x": 340,
              "y": 390
            },
            "vertices": [
              {
                "x": 220,
                "y": 310
              },
              {
                "x": 250,
                "y": 340
              },
              {
                "x": 270,
                "y": 350
              }
            ]
          },
          {
            "position": {
              "x": 470,
              "y": 260
            },
            "size": {
              "width": 120,
              "height": 150
            },
            "attrs": {
              "text": {
                "text": "HMI web interface"
              },
              "body": {
                "stroke": "red",
                "strokeWidth": 2.5,
                "strokeDasharray": null
              }
            },
            "visible": true,
            "shape": "process",
            "zIndex": 11,
            "ports": {
              "groups": {
                "top": {
                  "position": "top",
                  "attrs": {
                    "circle": {
                      "r": 4,
                      "magnet": true,
                      "stroke": "#5F95FF",
                      "strokeWidth": 1,
                      "fill": "#fff",
                      "style": {
                        "visibility": "hidden"
                      }
                    }
                  }
                },
                "right": {
                  "position": "right",
                  "attrs": {
                    "circle": {
                      "r": 4,
                      "magnet": true,
                      "stroke": "#5F95FF",
                      "strokeWidth": 1,
                      "fill": "#fff",
                      "style": {
                        "visibility": "hidden"
                      }
                    }
                  }
                },
                "bottom": {
                  "position": "bottom",
                  "attrs": {
                    "circle": {
                      "r": 4,
                      "magnet": true,
                      "stroke": "#5F95FF",
                      "strokeWidth": 1,
                      "fill": "#fff",
                      "style": {
                        "visibility": "hidden"
                      }
                    }
                  }
                },
                "left": {
                  "position": "left",
                  "attrs": {
                    "circle": {
                      "r": 4,
                      "magnet": true,
                      "stroke": "#5F95FF",
                      "strokeWidth": 1,
                      "fill": "#fff",
                      "style": {
                        "visibility": "hidden"
                      }
                    }
                  }
                }
              },
              "items": [
                {
                  "group": "top",
                  "id": "e4f344a7-22e4-42b8-8e62-3f2ec0eed053"
                },
                {
                  "group": "right",
                  "id": "c3c0af89-47a1-40d9-b315-cb65fea66e91"
                },
                {
                  "group": "bottom",
                  "id": "8ae89fca-2c2c-446d-a1e9-c6446e3d9a98"
                },
                {
                  "group": "left",
                  "id": "7b74e402-5923-4737-80cc-c7ebf60c95f3"
                }
              ]
            },
            "id": "22011c84-9c40-45b4-9ba1-ee4d292b4410",
            "data": {
              "type": "tm.Process",
              "name": "HMI web interface",
              "description": "",
              "outOfScope": false,
              "isTrustBoundary": false,
              "reasonOutOfScope": "",
              "hasOpenThreats": true,
              "handlesCardPayment": false,
              "handlesGoodsOrServices": false,
              "isWebApplication": true,
              "privilegeLevel": "",
              "threats": [
                {
                  "id": "524ac7f4-d080-4d6f-a79e-ac1ebb8f5026",
                  "title": "Spoofing HMI",
                  "status": "Open",
                  "severity": "Critical",
                  "type": "Spoofing",
                  "description": "Unauthorized users can access pump or dosing settings by the use of the internet. No authentication allows anyone to impersonate an operator via the public HMI.",
                  "mitigation": "Enforce some authentication with role based access control or VPN access only. Usernames passwords and one time passwords are also important. ",
                  "modelType": "STRIDE",
                  "new": false,
                  "number": 6,
                  "score": ""
                },
                {
                  "id": "6f10070f-ecf7-4588-a9cb-bbb1f422a742",
                  "title": "Dos web interface",
                  "status": "Open",
                  "severity": "High",
                  "type": "Denial of service",
                  "description": "Flooding the public HMI with repeated HTTP requests. Interface becomes unresponsive, halting operator visibility.",
                  "mitigation": "Implementing different countermeasures for dos attacks is important. Rate limiting and WAF are good against botnets and provide DDOS protection.",
                  "modelType": "STRIDE",
                  "new": false,
                  "number": 13,
                  "score": ""
                }
              ],
              "threatFrequency": {
                "spoofing": 4,
                "tampering": 0,
                "repudiation": 0,
                "informationDisclosure": 0,
                "denialOfService": 1,
                "elevationOfPrivilege": 0
              }
            }
          },
          {
            "position": {
              "x": 340.5,
              "y": 492
            },
            "size": {
              "width": 160,
              "height": 130
            },
            "attrs": {
              "text": {
                "text": "Process Database"
              },
              "body": {
                "stroke": "red",
                "strokeWidth": 2.5,
                "strokeDasharray": null
              }
            },
            "visible": true,
            "shape": "actor",
            "zIndex": 12,
            "ports": {
              "groups": {
                "top": {
                  "position": "top",
                  "attrs": {
                    "circle": {
                      "r": 4,
                      "magnet": true,
                      "stroke": "#5F95FF",
                      "strokeWidth": 1,
                      "fill": "#fff",
                      "style": {
                        "visibility": "hidden"
                      }
                    }
                  }
                },
                "right": {
                  "position": "right",
                  "attrs": {
                    "circle": {
                      "r": 4,
                      "magnet": true,
                      "stroke": "#5F95FF",
                      "strokeWidth": 1,
                      "fill": "#fff",
                      "style": {
                        "visibility": "hidden"
                      }
                    }
                  }
                },
                "bottom": {
                  "position": "bottom",
                  "attrs": {
                    "circle": {
                      "r": 4,
                      "magnet": true,
                      "stroke": "#5F95FF",
                      "strokeWidth": 1,
                      "fill": "#fff",
                      "style": {
                        "visibility": "hidden"
                      }
                    }
                  }
                },
                "left": {
                  "position": "left",
                  "attrs": {
                    "circle": {
                      "r": 4,
                      "magnet": true,
                      "stroke": "#5F95FF",
                      "strokeWidth": 1,
                      "fill": "#fff",
                      "style": {
                        "visibility": "hidden"
                      }
                    }
                  }
                }
              },
              "items": [
                {
                  "group": "top",
                  "id": "e72222e7-6458-4dce-8b44-af1514ffbd92"
                },
                {
                  "group": "right",
                  "id": "b784f26e-c23e-4e83-9156-07c0916b664b"
                },
                {
                  "group": "bottom",
                  "id": "f6dd2ff1-0ce5-4cd4-aa4a-65ddf048a168"
                },
                {
                  "group": "left",
                  "id": "eb3ba845-2ad5-4011-9220-e38d5d3c69eb"
                }
              ]
            },
            "id": "d5459573-9751-4e1c-934a-8c3dc688306d",
            "data": {
              "type": "tm.Actor",
              "name": "Process Database",
              "description": "stores info\n",
              "isTrustBoundary": false,
              "outOfScope": false,
              "reasonOutOfScope": "",
              "hasOpenThreats": true,
              "providesAuthentication": false,
              "threats": [
                {
                  "id": "6d996d8f-b157-4508-b6a3-0d63f9385d16",
                  "title": "Tampering",
                  "status": "Open",
                  "severity": "High",
                  "type": "Spoofing",
                  "description": "Direct database modification or SQL injection could corrupt historical data.",
                  "mitigation": "Queries, input validation, database hardening and least privilege accounts.",
                  "modelType": "STRIDE",
                  "new": false,
                  "number": 3,
                  "score": ""
                },
                {
                  "id": "2611c2d1-f4c6-408e-9df8-9cc26adad2b0",
                  "title": "Repudiation of database",
                  "status": "Open",
                  "severity": "Medium",
                  "type": "Repudiation",
                  "description": "System logs can be cleared or overwritten. Loss of history and evidence after an attack is a possibility.",
                  "mitigation": "Remote logging and append only log structure.",
                  "modelType": "STRIDE",
                  "new": false,
                  "number": 10,
                  "score": ""
                }
              ],
              "threatFrequency": {
                "spoofing": 2,
                "repudiation": 2
              }
            }
          },
          {
            "position": {
              "x": 840,
              "y": 40
            },
            "size": {
              "width": 240,
              "height": 170
            },
            "attrs": {
              "text": {
                "text": "web interface"
              },
              "body": {
                "stroke": "red",
                "strokeWidth": 2.5,
                "strokeDasharray": null
              }
            },
            "visible": true,
            "shape": "process",
            "zIndex": 13,
            "ports": {
              "groups": {
                "top": {
                  "position": "top",
                  "attrs": {
                    "circle": {
                      "r": 4,
                      "magnet": true,
                      "stroke": "#5F95FF",
                      "strokeWidth": 1,
                      "fill": "#fff",
                      "style": {
                        "visibility": "hidden"
                      }
                    }
                  }
                },
                "right": {
                  "position": "right",
                  "attrs": {
                    "circle": {
                      "r": 4,
                      "magnet": true,
                      "stroke": "#5F95FF",
                      "strokeWidth": 1,
                      "fill": "#fff",
                      "style": {
                        "visibility": "hidden"
                      }
                    }
                  }
                },
                "bottom": {
                  "position": "bottom",
                  "attrs": {
                    "circle": {
                      "r": 4,
                      "magnet": true,
                      "stroke": "#5F95FF",
                      "strokeWidth": 1,
                      "fill": "#fff",
                      "style": {
                        "visibility": "hidden"
                      }
                    }
                  }
                },
                "left": {
                  "position": "left",
                  "attrs": {
                    "circle": {
                      "r": 4,
                      "magnet": true,
                      "stroke": "#5F95FF",
                      "strokeWidth": 1,
                      "fill": "#fff",
                      "style": {
                        "visibility": "hidden"
                      }
                    }
                  }
                }
              },
              "items": [
                {
                  "group": "top",
                  "id": "e4f344a7-22e4-42b8-8e62-3f2ec0eed053"
                },
                {
                  "group": "right",
                  "id": "c3c0af89-47a1-40d9-b315-cb65fea66e91"
                },
                {
                  "group": "bottom",
                  "id": "8ae89fca-2c2c-446d-a1e9-c6446e3d9a98"
                },
                {
                  "group": "left",
                  "id": "7b74e402-5923-4737-80cc-c7ebf60c95f3"
                }
              ]
            },
            "id": "cf4b2fca-947f-473a-a644-d47a6fba299c",
            "data": {
              "type": "tm.Process",
              "name": "web interface",
              "description": "",
              "outOfScope": false,
              "isTrustBoundary": false,
              "reasonOutOfScope": "",
              "hasOpenThreats": true,
              "handlesCardPayment": false,
              "handlesGoodsOrServices": false,
              "isWebApplication": true,
              "privilegeLevel": "",
              "threats": [
                {
                  "id": "6dbccd88-7b71-4421-9b14-92ccf3f1b49e",
                  "title": "Repudiation of the web interface",
                  "status": "Open",
                  "severity": "Medium",
                  "type": "Repudiation",
                  "description": "No audit logging of operator actions. in the picture it only shows \"me\". Hard to trace who changed pump or dosing settings.",
                  "mitigation": "Implement a centralized and a audit logger with timestamps. Some of this is already in place. ",
                  "modelType": "STRIDE",
                  "new": false,
                  "number": 9,
                  "score": ""
                },
                {
                  "id": "0edf4556-c5c8-48c8-bee8-e1443f33129a",
                  "title": "info disc with the web interface",
                  "status": "Open",
                  "severity": "High",
                  "type": "Information disclosure",
                  "description": "Process values like flow, pH and dosage are publicly visible without authentication. Attackers can monitor plant performance and detect vulnerabilities.",
                  "mitigation": "Require login to view this, as well as applying least privilege access. Should also restrict public endpoints.",
                  "modelType": "STRIDE",
                  "new": false,
                  "number": 11,
                  "score": ""
                }
              ],
              "threatFrequency": {
                "spoofing": 0,
                "tampering": 0,
                "repudiation": 1,
                "informationDisclosure": 1,
                "denialOfService": 0,
                "elevationOfPrivilege": 0
              }
            }
          },
          {
            "position": {
              "x": 1145,
              "y": 210
            },
            "size": {
              "width": 190,
              "height": 160
            },
            "attrs": {
              "text": {
                "text": "Control server"
              },
              "body": {
                "stroke": "red",
                "strokeWidth": 2.5,
                "strokeDasharray": null
              }
            },
            "visible": true,
            "shape": "process",
            "zIndex": 14,
            "ports": {
              "groups": {
                "top": {
                  "position": "top",
                  "attrs": {
                    "circle": {
                      "r": 4,
                      "magnet": true,
                      "stroke": "#5F95FF",
                      "strokeWidth": 1,
                      "fill": "#fff",
                      "style": {
                        "visibility": "hidden"
                      }
                    }
                  }
                },
                "right": {
                  "position": "right",
                  "attrs": {
                    "circle": {
                      "r": 4,
                      "magnet": true,
                      "stroke": "#5F95FF",
                      "strokeWidth": 1,
                      "fill": "#fff",
                      "style": {
                        "visibility": "hidden"
                      }
                    }
                  }
                },
                "bottom": {
                  "position": "bottom",
                  "attrs": {
                    "circle": {
                      "r": 4,
                      "magnet": true,
                      "stroke": "#5F95FF",
                      "strokeWidth": 1,
                      "fill": "#fff",
                      "style": {
                        "visibility": "hidden"
                      }
                    }
                  }
                },
                "left": {
                  "position": "left",
                  "attrs": {
                    "circle": {
                      "r": 4,
                      "magnet": true,
                      "stroke": "#5F95FF",
                      "strokeWidth": 1,
                      "fill": "#fff",
                      "style": {
                        "visibility": "hidden"
                      }
                    }
                  }
                }
              },
              "items": [
                {
                  "group": "top",
                  "id": "e4f344a7-22e4-42b8-8e62-3f2ec0eed053"
                },
                {
                  "group": "right",
                  "id": "c3c0af89-47a1-40d9-b315-cb65fea66e91"
                },
                {
                  "group": "bottom",
                  "id": "8ae89fca-2c2c-446d-a1e9-c6446e3d9a98"
                },
                {
                  "group": "left",
                  "id": "7b74e402-5923-4737-80cc-c7ebf60c95f3"
                }
              ]
            },
            "id": "1dd0583a-3d46-4628-b219-a07ca88c2611",
            "data": {
              "type": "tm.Process",
              "name": "Control server",
              "description": "",
              "outOfScope": false,
              "isTrustBoundary": false,
              "reasonOutOfScope": "",
              "hasOpenThreats": true,
              "handlesCardPayment": false,
              "handlesGoodsOrServices": false,
              "isWebApplication": false,
              "privilegeLevel": "",
              "threats": [
                {
                  "id": "773c5d03-db3a-48f8-be3f-935860d66d7b",
                  "title": "spoofing",
                  "status": "Open",
                  "severity": "Critical",
                  "type": "Spoofing",
                  "description": "PLC devices do not verify the source of control commands. Attackers can inject fake dosing or pH control signals via the PLC",
                  "mitigation": "Use device certificates, signed control messages and allow list IDs.",
                  "modelType": "STRIDE",
                  "new": false,
                  "number": 2,
                  "score": ""
                }
              ],
              "threatFrequency": {
                "spoofing": 2,
                "tampering": 0,
                "repudiation": 0,
                "informationDisclosure": 0,
                "denialOfService": 0,
                "elevationOfPrivilege": 0
              }
            }
          },
          {
            "position": {
              "x": 975,
              "y": 610
            },
            "size": {
              "width": 170,
              "height": 150
            },
            "attrs": {
              "text": {
                "text": "PLCs and Field Devices "
              },
              "body": {
                "stroke": "#333333",
                "strokeWidth": 1.5,
                "strokeDasharray": null
              }
            },
            "visible": true,
            "shape": "actor",
            "zIndex": 15,
            "ports": {
              "groups": {
                "top": {
                  "position": "top",
                  "attrs": {
                    "circle": {
                      "r": 4,
                      "magnet": true,
                      "stroke": "#5F95FF",
                      "strokeWidth": 1,
                      "fill": "#fff",
                      "style": {
                        "visibility": "hidden"
                      }
                    }
                  }
                },
                "right": {
                  "position": "right",
                  "attrs": {
                    "circle": {
                      "r": 4,
                      "magnet": true,
                      "stroke": "#5F95FF",
                      "strokeWidth": 1,
                      "fill": "#fff",
                      "style": {
                        "visibility": "hidden"
                      }
                    }
                  }
                },
                "bottom": {
                  "position": "bottom",
                  "attrs": {
                    "circle": {
                      "r": 4,
                      "magnet": true,
                      "stroke": "#5F95FF",
                      "strokeWidth": 1,
                      "fill": "#fff",
                      "style": {
                        "visibility": "hidden"
                      }
                    }
                  }
                },
                "left": {
                  "position": "left",
                  "attrs": {
                    "circle": {
                      "r": 4,
                      "magnet": true,
                      "stroke": "#5F95FF",
                      "strokeWidth": 1,
                      "fill": "#fff",
                      "style": {
                        "visibility": "hidden"
                      }
                    }
                  }
                }
              },
              "items": [
                {
                  "group": "top",
                  "id": "e72222e7-6458-4dce-8b44-af1514ffbd92"
                },
                {
                  "group": "right",
                  "id": "b784f26e-c23e-4e83-9156-07c0916b664b"
                },
                {
                  "group": "bottom",
                  "id": "f6dd2ff1-0ce5-4cd4-aa4a-65ddf048a168"
                },
                {
                  "group": "left",
                  "id": "eb3ba845-2ad5-4011-9220-e38d5d3c69eb"
                }
              ]
            },
            "id": "54864b68-7021-4826-b997-6e01bfedc12f",
            "data": {
              "type": "tm.Actor",
              "name": "PLCs and Field Devices ",
              "description": "",
              "isTrustBoundary": false,
              "outOfScope": false,
              "reasonOutOfScope": "",
              "hasOpenThreats": false,
              "providesAuthentication": true,
              "threats": []
            }
          }
        ]
      }
    ],
    "diagramTop": 1,
    "reviewer": "",
    "threatTop": 13
  }
}